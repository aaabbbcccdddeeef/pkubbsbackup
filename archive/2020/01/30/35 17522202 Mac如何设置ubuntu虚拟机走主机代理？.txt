#t 35 17522202 XiaoNi 2020-01-30 00:13:00 XiaoNi 2020-01-30 17:52:00
Mac如何设置ubuntu虚拟机走主机代理？

#p 21780676 XiaoNi \varnothing 2020-01-30 13:15:21
Parallels Desktop装的ubuntu虚拟机，主机Macos已经用ss代理。打算让ubuntu也用ss代理。但是小白弄了一天也没设置成功，所以打算直接让ubuntu走主机的ss，请问这样可行吗？可以的话麻烦告诉我怎么操作，十分感谢。

#p 21780733 hiaoxui 小辉 2020-01-30 13:37:27
这应该不是一个简单的问题...
我的解决方案是再开一台虚拟机当路由器, 用 REDSOCKS 把  PREROUTING 的包交给 SS 代理.
如果没有太变态的需求的话, 可以考虑直接在 ubuntu 上运行 ss, 应该是更简洁的解决方案.
#quote XiaoNi

#p 21780930 XiaoNi \varnothing 2020-01-30 14:38:16
怎么在ubuntu上直接运行ss？
我的操作一：1.下载安装ss-qt；2.填写配置（直接由二维码导入，在mac端测试过节点有效）；3.连接。
结果：失败。
我的操作二：1:用命令行安装ss; 2.在/etc文件夹导入配置shadowsock.json；3.用命令行sudo ssserver -c /etc/shadowsocks.json -d start启动；4.用命令行sudo systemctl status rc-local.service检测。
结果：显示inactive(dead)
请问我这两种方法的哪几步错了ಥ_ಥ
#quote hiaoxui

#p 21781139 dingbur dingbur 2020-01-30 15:39:48
ubuntu直接运行ss肯定是最简单的方法。
单说你的方法2，我不是ubuntu用户，不太清楚ubuntu的配置细节。但是如果你手动运行ssserver，那就不能用systemctl去查它的状态，直接ps aux | grep ssserver看看有没有对应进程就行。在调试的时候可以把参数-d start去掉在前台运行，看看log有没有问题。确认没有问题以后再加上-d start后台启动或者直接用systemd管理。
#quote XiaoNi

#p 21781500 gspku null 2020-01-30 17:47:00


2020-01-30 17:30:08
先说一下操作二里的错误：
rc-local.service是开机一次性执行性质的系统服务，执行完自然会退出进入inactive状态，是正常现象。
sudo ssserver -c /etc/shadowsocks.json -d start命令的作用是启动ss服务器并且在后台运行，并不会自动设置开机自启，和rc.local没有任何关系。自然用systemctl无法检查它的状态。而且你这里不应该用ssserver，客户端应该用sslocal才对。
操作一（使用ss-qt）应该是正确的
“失败”具体指什么情况？ 是指程序不走SS吗？
Linux里的ss是没有全局代理功能的（不准确，暂且这么理解）。也就是说，单纯启动ss之后，各种程序是不走SS的。需要设置程序使用SOCKS5代理（地址127.0.0.1，端口是ss里设置的本地端口），才能走SS。
Chrome和Firefox浏览器可以使用SwitchyOmega扩展来实现自动切换代理的功能。
关于这些问题的解决方法，目前网上还是较容易找到的，就算是使用不靠谱的百度搜索“ss-qt”，也能搜到一些有用的解答。
#quote XiaoNi

#p 21781537 XiaoNi \varnothing 2020-01-30 17:51:18
第二种我看不懂了:)，那先说第一种吧：
我说的失败是指firefox无法访问外网，其他程序暂时没有试过。
另外“设置程序使用SOCK5代理”具体应该怎么操作？
设置成功之后Firefox还需要使用那个拓展吗？
其他程序（如邮箱）应该怎么做才能访问外网？
谢谢回答🐶
#quote gspku

