#t 35 17503137 xywd 2020-01-14 00:14:00 leonlulu 2020-01-14 17:07:00
疑似感染挖矿病毒

#p 21714452 xywd 淆紊 2020-01-14 16:33:44


2020-01-14 14:28:56
通过抓包分析，感觉大概是挖的门罗币，如图3。
更新----------------------
前几天发现有人在我们物院的linux服务器上挖矿，只是找出来把挖矿程序给关了。
（师兄语）为了警示对方，在挖矿程序里面写了一句话"挖矿死全家！"，期望对方看见如此恶毒的诅咒，能够迷途知返，改过自新。
但是。。。
今天中午12点左右，该进程又阴魂不散地异常启动，可见对方在诅咒面前也毫无悔意，以丧失人性。(当然别人看不见啊，人家都是覆盖的啊，师弟说
通过任务号扒出了对方的ip:162.105.92.117:8181。查了查可能是28楼的。
在把/etc/ld.so.preload 里面的内容删掉可以查看隐藏进程
一般挖矿程序(比如上次/var/lib/,这次在/usr/local/lib/下面有一个.lib)文件夹。利用root权限的crontab随时重启。
之前由于另外一个师弟的服务器也感染了挖矿软件，所以提醒物院的大家查看一下自己的服务器有没有被一个隐藏进程占用cpu感染挖矿程序。
最后附上师兄一句话：卿本佳人，奈何做贼？？？？坚决抵制企图不劳而获的行为。

#p 21714472 lyylyy gedebahe 2020-01-14 14:33:51
作为被害者之一，我认为要挖矿自己交电费偷偷的挖，坚决反对这种利用别人服务器加学院电费为自己谋取利益的行为
#quote xywd

#p 21714482 dp Dynamic Programming 2020-01-14 14:35:57
tcpdump抓个包。。。看看挖的啥
#quote xywd

#p 21714550 merlyn 梅林 2020-01-14 14:47:17
顶！谴责这种行为
#quote xywd

#p 21714564 mycNoone 雪菜厨|傻狗|重度ky患者 2020-01-14 14:50:27
已经转发到校长信箱和计算中心了
#quote xywd

#p 21714568 sxpeter  2020-01-14 14:50:43
那个IP说不定是个肉鸡吧。。
#quote xywd

#p 21714594 merlyn 梅林 2020-01-14 14:57:03
@PKUCC 希望计算中心的老师帮助调查！
#quote xywd

#p 21714614 Speedster 胖胖的猪 2020-01-14 15:02:26
强烈谴责！
#quote xywd

#p 21714626 Speedster 胖胖的猪 2020-01-14 15:04:36
有没有大牛给一些防御和清除挖矿病毒的建议
#quote xywd

#p 21714637 Raypotter Raychuw 2020-01-14 15:06:56
顶贴，希望挖矿同学收手，不要占用我们宝贵的计算资源
#quote xywd

#p 21714648 Raypotter Raychuw 2020-01-14 15:09:04
大家都去自己服务器上看看，有没有类似的，可能有的账号密码太弱被撞库撞到了。论设一个复杂密码的重要性
#quote xywd

#p 21714673 jiamingpku jiamingpku 2020-01-14 15:17:26
#DELETED
肉什么？
#quote sxpeter

#p 21714721 Speedster 胖胖的猪 2020-01-14 15:31:15
联系前段时间校园网关闭入栈连接。其实不是校外人员攻击校园网，而是校园里有内鬼？？？
@PKUCC 
#quote xywd

#p 21714725 juruo 蒟蒻太蒻了嘤嘤嘤 2020-01-14 15:32:17
之前服务器也有过，后来rm掉bin文件清了crontab，所有用户都换成强密码就好了
#quote xywd

#p 21714782 xxpthu xxpthu 2020-01-14 15:48:43
肉鸡儿啊
#quote jiamingpku

#p 21714811 xywd 淆紊 2020-01-14 15:54:38
不能武断下结论orz。很可能是跳板ip
#quote Speedster

#p 21714876 IlIl 王铁崖 2020-01-14 16:09:26
说_不说_，文明你我他。
#quote sxpeter

#p 21714930 kissme 臭薯条酱 2020-01-14 16:19:58
霍，🐮🍺，有这种事，我马上举报
#quote xywd

#p 21714976 RyanBern r.bern 2020-01-14 16:38:58


2020-01-14 16:29:52
不一定是校内学生干的，有可能只是校内被感染的肉鸡。
在计算中心没有封禁端口的时候，校内几乎每天都有这种肉鸡攻击别的服务器。最常见的原因是该肉鸡的负责人服务器安全知识不足，例如允许 root 登录，root 弱密码等，nfs 挂载权限过大也是常见漏洞之一。不过现在计算中心封了端口，情况好好多，但安全不是绝对的。还是有如下感染病毒的可能：
1. 校内学生个人电脑中毒，然后病毒利用该学生的电脑攻击服务器，所到之处一概挖矿。
2. 该服务器已经备案，但服务器管理员安全知识不足。（一旦备案，该服务器会暴露在公网之下，和未封禁时情况相似）
3. 有内鬼（用户乃至管理员）故意挖矿。例如数院服务器就中过这种挖矿病毒，不过现在病毒已经毕业了。
个人觉得预防的作用要大于出问题进行处理的作用。病毒也有自我保护措施，如开守护进程，篡改系统程序（想想你的系统 ls，ps 等程序都不可靠的时候，你还能怎么清除？），配合 crontab 自动重启等。预防的话，主要可以从以下方面做起：
1. 禁止 root 的 ssh 登录，或者仅允许 public key 验证方式。这个很重要，99% 的黑客都会优先攻击 root 账号。此外，服务器厂商的测试账号也要禁止或者删除。
2. 用户不要使用弱密码。这个可以管理员定期检查，推荐一个叫 john the ripper 的软件对密码进行暴破，如果 x 天暴破出来用户的密码则需要提醒用户修改。
3. 登录节点配置系统防火墙。centos 7 以上的 firewalld 比较好学，可以试一下。
4. 检查 nfs 等配置权限。我的第一台服务器就是因为 nfs 的权限开大了被黑的，当时是被一个白帽提醒的。
5. 如果你的机器不需要校外访问，请不要申请备案。计算中心的墙能减少被校外攻击的几率。
6. 安装 fail2ban 软件，检查外界的暴破攻击，配合防火墙使用。
7. 雇一个懂服务器安全的管理员。或外包给计算中心。
#quote xywd

#p 21715023 xywd 淆紊 2020-01-14 16:39:26
赞同大佬分析，还是做好自己服务器的预防是上上策。
#quote RyanBern

#p 21715034 qiyu 齐羽 2020-01-14 16:41:49
还可以卖400多块一个呢😍
#quote xywd

#p 21715134 Speedster 胖胖的猪 2020-01-14 17:01:41
好像用CPU挖的一般都是门罗币
#quote xywd

#p 21715150 leonlulu leon 2020-01-14 17:06:43
之前有人用我们实验室的服务器挖以太坊，CPU和GPU都有，屡禁不止。。后来是删除了所有毕业的学生的账户，强制让大家都换成强密码。。
#quote xywd

