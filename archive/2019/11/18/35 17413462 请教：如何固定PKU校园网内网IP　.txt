#t 35 17413462 shzmcxk 2019-11-18 00:18:00 RyanBern 2019-11-19 09:27:00
请教：如何固定PKU校园网内网IP　

#p 21345694 shzmcxk 练习时长三年的练习生 2019-11-18 18:17:54
为了常年放在实验室的一台windows游戏本的远程连接方便，希望能固定其内网IP。
按照正常指定IP操作，做如下配置：
ip：10.0.30.251
子网掩码：255.255.252.0
默认网关：10.0.28.1
首选DNS：162.105.129.122
备选DNS：162.105.129.102
然后，虽然显示了连接，但是无法访问任何内网或者外网。用其他在pku校园网的电脑也ping不通。
目前在使用的是个备选的方案：用一个脚本随时把当前内网ip解析到一个域名（也就是动态DNS），但还是希望了解一下PKU校园网有没有手动指定IP的方法。

#p 21345794 shzmcxk 练习时长三年的练习生 2019-11-18 18:36:44
这个10.0.30.251是随便指定的，也尝试换过好几个。而且也都有先ping一下看看是不是已经被占用，但是都不行。
感觉就是好像不允许自己指定自己的IP？
不知道有没有自己指定IP的方法。
#quote shzmcxk

#p 21345813 dvorah 尺蠖·德沃夏蛤 2019-11-18 18:41:31
一些楼里会有固定IP，自己用的话需要申请 可以去看一下PKU_CC版
#quote shzmcxk

#p 21345873 Smallst Fox loves sea. 2019-11-18 18:52:34
首先，如果实验室电脑连的是有线网络，一般都是固定的ip，至少可以按学期认为是固定的，你可以尝试反复断开和重新连接网关，你会发现是一样的ip
然后，可靠固定的ip可以上its下载申请表申请，但应该只支持老师申请，即不接受学生个人申请
#quote shzmcxk

#p 21346081 shzmcxk 练习时长三年的练习生 2019-11-18 19:37:59
感谢楼上各位。
了解了一下，确实固定ipv4的地址需要“教职工”写申请。有线网具体没有尝试，因为这里的有线网已经不知道过了几层NAT了= =
另外发现IPv6地址好像不会变化？（存疑），其实远程连接用ipv6地址也可行，这个我用一段时间试一下会不会变吧。
#quote shzmcxk

#p 21346264 Smallst Fox loves sea. 2019-11-18 20:17:13
其实如果nat都不重启的话好像也是不影响的hhh
不过校内v6确实也是个方案
#quote shzmcxk

#p 21346452 lldsolitude 我要长大 2019-11-18 20:45:19
要想IPv6地址不变需要关掉SLAAC privacy extension，不同操作系统方法不同，可以搜一下。
#quote shzmcxk

#p 21348385 hiaoxui 小辉 2019-11-19 01:38:57
是不是可以这样, 在电脑上跑一个脚本检测自己的 IP, 然后用一个域名去解析. 像 Cloudflare 都有提供 API, 可以用脚本修改解析.
#quote shzmcxk

#p 21349157 RyanBern r.bern 2019-11-19 09:27:05
从楼主给的 IP 来看，属于北大 Wifi 网段。如果采用有线网获取的公网 IP 应当为：162.105.x.x 或 115.27.x.x 或 222.29.x.x，在宿舍楼内的有线网是局域网 IP：10.128.x.x。因此不太推荐用公共 Wifi 分配的 IP 进行服务器搭建。
一般的实验室有线网都会分配一个公网 IP，如楼上所说，这个公网 IP 变化频率非常低，有时候用一年多都不会变，所以应该不是问题。而正规的固定 IP 是要去到计算中心申请的，学生个人不能申请固定 IP。
另外有一件事得提醒一下楼主：私自给自己的设备指定固定 IP 已经违反了计算中心的用户守则。详见 [https://its.pku.edu.cn/rule_campus_network.jsp](jump-to.php?url=https%3A%2F%2Fits.pku.edu.cn%2Frule_campus_network.jsp) 的第十三条：校园网域名和IP地址由计算中心统一管理和分配，任何人不得任意改动和抢占。
暂时不是特别清楚将非北大（或教育网）域名解析到校内地址算不算违规。但还是当心一下，不要违反规定了。
---
计算中心目前（2019.11.18）对 IPv4 限制非常严格，但指定固定 IPv6 地址是可能的。北大 IPv6 的前面若干位是固定的，即 2001:da8:201，而后面一组和地理位置有关（有一定规律），但一般来讲 prefix 是 64 位。因此楼主可以先观察一下自动获取的的 IPv6 地址，测试能用之后用一般的方式设置固定 IPv6 地址即可。网关是当前网段的第一个 IP，DNS 可以留空让主机自己解析。
#quote shzmcxk

